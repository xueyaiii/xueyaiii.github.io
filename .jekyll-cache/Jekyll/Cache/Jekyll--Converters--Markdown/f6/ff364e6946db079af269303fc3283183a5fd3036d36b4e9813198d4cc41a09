I"» <head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

<h1 id="å®ç°logisticå›å½’">å®ç°Logisticå›å½’</h1>
<h2 id="åŸç†">åŸç†</h2>
<h3 id="æ¦‚è¿°">æ¦‚è¿°</h3>
<ul>
  <li>æœ‰æ ‡ç­¾åˆ†ç±»ç®—æ³•</li>
  <li>ä¸»è¦æ€æƒ³ï¼šç”±ç°æœ‰æ•°æ®å¯¹åˆ†ç±»è¾¹ç•Œçº¿è¿›è¡Œåˆ†ç±»</li>
</ul>

<h3 id="æ•°å­¦èƒŒæ™¯">æ•°å­¦èƒŒæ™¯</h3>
<h4 id="å›å½’">å›å½’</h4>
<p>ç”¨ä¸€æ¡ç›´çº¿å¯¹å·²çŸ¥çš„æ•°æ®ç‚¹è¿›è¡Œæ‹Ÿåˆ</p>
<h4 id="sigmoidå‡½æ•°">Sigmoidå‡½æ•°</h4>
<ul>
  <li>å…¬å¼ï¼š
<script type="math/tex">\sigma(z)=\frac{1}{1+e^{-z}}</script></li>
  <li>$z$ä¸º0æ—¶ï¼Œ$\sigma(z)$ä¸º0.5ï¼Œ$z$ä¸º$+\infty$ï¼Œ$\sigma(z)$ä¸º1ï¼Œ$z$ä¸º$-\infty$ï¼Œ$\sigma(z)$ä¸º0</li>
  <li>å¦‚æœæ¨ªåæ ‡åˆ»åº¦è¶³å¤Ÿå¤§ï¼ŒSigmoidå‡½æ•°å°±åƒä¸€ä¸ªé˜¶è·ƒå‡½æ•°ï¼Œå¯ä»¥è¾¾åˆ°åˆ†ç±»çš„ç›®çš„
    <h4 id="å¼•å…¥logisticåˆ†ç±»å™¨">å¼•å…¥Logisticåˆ†ç±»å™¨</h4>
  </li>
  <li>åœ¨æ¯ä¸ªç‰¹å¾$x_{i}$ä¸Šä¹˜ä¸Šä¸€ä¸ªå›å½’ç³»æ•°$w_{i}$,ç›¸åŠ å¾—åˆ°$z$(<strong>æ‹Ÿåˆ</strong>)ï¼Œå°†$z$ä»£å…¥Sigmoidå‡½æ•°ï¼Œä»»ä½•å¤§äº 0.5 çš„æ•°æ®è¢«åˆ†å…¥ 1 ç±»ï¼Œå°äº 0.5 å³è¢«å½’å…¥ 0 ç±»
<script type="math/tex">z=w_{0} x_{0}+w_{1} x_{1}+w_{2} x_{2}+\ldots+w_{n} x_{n}</script>
å³ï¼š
<script type="math/tex">z=w^{T} x</script></li>
  <li>æˆ‘ä»¬ç°åœ¨çš„ç›®æ ‡æ˜¯æ±‚è§£è¿™äº›å›å½’ç³»æ•°$w_{i}$
    <h4 id="åŸºäºæ¢¯åº¦ä¸Šå‡æ³•ç¡®å®šå›å½’ç³»æ•°æ‹Ÿåˆ">åŸºäºæ¢¯åº¦ä¸Šå‡æ³•ç¡®å®šå›å½’ç³»æ•°ï¼ˆæ‹Ÿåˆï¼‰</h4>
  </li>
  <li>è®¾æ ·æœ¬çš„ç±»åˆ«æ ‡ç­¾ä¸º$y$ï¼Œå›å½’ç³»æ•°ä¸º$w$ï¼Œæ ·æœ¬çŸ©é˜µä¸º$x$ï¼Œè¯¯å·®ä¸º$e$ï¼Œæ­¥é•¿ä¸º$alpha$ã€‚</li>
  <li>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å°åŒ–è¯¯å·®$e^{T} e$(å› ä¸ºæ˜¯åˆ—å‘é‡)åè¿‡æ¥å°±æ˜¯æœ€å¤§åŒ–$-e^{T} e$ï¼Œä¸ºæ¶ˆå»å› å­ï¼Œæ­¤å¤„æœ€å¤§åŒ–$-\frac{1}{2} e^{T} e$</li>
  <li>$-\frac{1}{2} e^{T} e=-\frac{1}{2}(x w-y)^{T}(x w-y)=f(w)$æ‹†å¼€æ¥å°±æ˜¯ï¼š$f(w)=-\frac{1}{2}\left(w^{T} x^{T}-y\right)(x w-y)=-\frac{1}{2}\left(w^{T} x^{T} x w-w^{T} x^{T} y-y^{T} x w+y^{T} y\right)$</li>
  <li>åˆ°è¿™å°±å¯ä»¥ç”¨æ¢¯åº¦ä¸Šå‡ç®—æ³•ï¼Œå¯¹æ±‚å¯¼å¯ä»¥å¾—å‡º$\frac{\partial f(w)}{\partial w}=x^{T} y-x^{T} x w=x^{T}(y-w x)=x^{T} e$</li>
  <li>æ›´æ–°å›å½’ç³»æ•°çš„å…¬å¼å°±æ˜¯ï¼š$w=w+\alpha x^{T} e$
    <h3 id="logistic-ç®—æ³•è¿‡ç¨‹">Logistic ç®—æ³•è¿‡ç¨‹</h3>
    <h4 id="logistic-å›å½’ç®—æ³•">Logistic å›å½’ç®—æ³•</h4>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>åˆå§‹åŒ–æ‰€æœ‰å›å½’ç³»æ•°  
é‡å¤Ræ¬¡ï¼š  
  è®¡ç®—æ•´ä¸ªæ•°æ®é›†æ¢¯åº¦
  ä½¿ç”¨ æ­¥é•¿ä¹˜ä»¥æ¢¯åº¦ æ›´æ–°å›å½’ç³»æ•°
è¿”å›å›å½’ç³»æ•°
</code></pre></div>    </div>
    <h4 id="logistic-å›å½’-å¼€å‘æµç¨‹">Logistic å›å½’ å¼€å‘æµç¨‹</h4>
    <p>æ”¶é›†æ•°æ®
å‡†å¤‡æ•°æ®: ç”±äºéœ€è¦è¿›è¡Œè·ç¦»è®¡ç®—ï¼Œå› æ­¤è¦æ±‚æ•°æ®ç±»å‹ä¸ºæ•°å€¼å‹ã€‚
åˆ†ææ•°æ®
è®­ç»ƒç®—æ³•: æ‰¾åˆ°æœ€ä½³çš„åˆ†ç±»å›å½’ç³»æ•°ã€‚
æµ‹è¯•ç®—æ³•</p>
    <h2 id="å®ä¾‹">å®ä¾‹</h2>
    <h3 id="ç®—æ³•">ç®—æ³•</h3>
    <p>```python
import numpy as np
import matplotlib.pyplot as plt</p>
  </li>
</ul>

<h1 id="è§£ææ•°æ®">è§£ææ•°æ®</h1>
<p>def loadDataSet(file_name):
    # dataMatä¸ºåŸå§‹æ•°æ®ï¼Œ labelMatä¸ºåŸå§‹æ•°æ®çš„æ ‡ç­¾
    dataMat = []
    labelMat = []</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fr = open(file_name)
for line in fr.readlines():
    lineArr = line.strip().split()
    if len(lineArr) == 1:
        continue    # è¿™é‡Œå¦‚æœå°±ä¸€ä¸ªç©ºçš„å…ƒç´ ï¼Œåˆ™è·³è¿‡æœ¬æ¬¡å¾ªç¯
    # ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œæˆ‘ä»¬å°† X0 çš„å€¼è®¾ä¸º 1.0 ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¯ä¸€è¡Œçš„å¼€å¤´æ·»åŠ ä¸€ä¸ª 1.0 ä½œä¸º X0
    dataMat.append([1.0, float(lineArr[0]), float(lineArr[1])])
    labelMat.append(int(lineArr[2]))
return dataMat, labelMat
</code></pre></div></div>

<h1 id="sigmoidè·³è·ƒå‡½æ•°">sigmoidè·³è·ƒå‡½æ•°</h1>
<p>def sigmoid(inX):
    # return 1.0 / (1 + exp(-inX))</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Tanhæ˜¯Sigmoidçš„å˜å½¢ï¼Œä¸ sigmoid ä¸åŒçš„æ˜¯ï¼Œtanh æ˜¯0å‡å€¼çš„ã€‚å› æ­¤ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œtanh ä¼šæ¯” sigmoid æ›´å¥½ã€‚
return 2 * 1.0/(1+np.exp(-2*inX)) - 1
</code></pre></div></div>

<h1 id="éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•éšæœºåŒ–">éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆéšæœºåŒ–ï¼‰</h1>
<p>def stocGradAscent(dataMatrix, classLabels, numIter=150):
    â€˜â€™â€™
    Desc:
        æ”¹è¿›ç‰ˆçš„éšæœºæ¢¯åº¦ä¸‹é™ï¼Œä½¿ç”¨éšæœºçš„ä¸€ä¸ªæ ·æœ¬æ¥æ›´æ–°å›å½’ç³»æ•°
    Args:
        dataMatrix â€“ è¾“å…¥æ•°æ®çš„æ•°æ®ç‰¹å¾ï¼ˆé™¤å»æœ€åä¸€åˆ—æ•°æ®ï¼‰
        classLabels â€“ è¾“å…¥æ•°æ®çš„ç±»åˆ«æ ‡ç­¾ï¼ˆæœ€åä¸€åˆ—æ•°æ®ï¼‰
        numIter=150 â€“  è¿­ä»£æ¬¡æ•°
    Returns:
        weights â€“ å¾—åˆ°çš„æœ€ä½³å›å½’ç³»æ•°
    â€˜â€™â€™
    m, n = np.shape(dataMatrix)
    weights = np.ones(n)  # åˆ›å»ºä¸åˆ—æ•°ç›¸åŒçš„çŸ©é˜µçš„ç³»æ•°çŸ©é˜µï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½æ˜¯1
    # éšæœºæ¢¯åº¦, å¾ªç¯150,è§‚å¯Ÿæ˜¯å¦æ”¶æ•›
    for j in range(numIter):
        # [0, 1, 2 .. m-1]
        dataIndex = list(range(m))
        for i in range(m):
            # iå’Œjçš„ä¸æ–­å¢å¤§ï¼Œå¯¼è‡´alphaçš„å€¼ä¸æ–­å‡å°‘ï¼Œä½†æ˜¯ä¸ä¸º0
            alpha = 4 / (
                1.0 + j + i
            ) + 0.0001  # alpha ä¼šéšç€è¿­ä»£ä¸æ–­å‡å°ï¼Œä½†æ°¸è¿œä¸ä¼šå‡å°åˆ°0ï¼Œå› ä¸ºåè¾¹è¿˜æœ‰ä¸€ä¸ªå¸¸æ•°é¡¹0.0001
            # éšæœºäº§ç”Ÿä¸€ä¸ª 0ï½len()ä¹‹é—´çš„ä¸€ä¸ªå€¼
            # random.uniform(x, y) æ–¹æ³•å°†éšæœºç”Ÿæˆä¸‹ä¸€ä¸ªå®æ•°ï¼Œå®ƒåœ¨[x,y]èŒƒå›´å†…,xæ˜¯è¿™ä¸ªèŒƒå›´å†…çš„æœ€å°å€¼ï¼Œyæ˜¯è¿™ä¸ªèŒƒå›´å†…çš„æœ€å¤§å€¼ã€‚
            randIndex = int(np.random.uniform(0, len(dataIndex)))
            # sum(dataMatrix[i]<em>weights)ä¸ºäº†æ±‚ f(x)çš„å€¼ï¼Œ f(x)=a1</em>x1+b2<em>x2+..+nn</em>xn
            h = sigmoid(sum(dataMatrix[dataIndex[randIndex]] * weights))
            error = classLabels[dataIndex[randIndex]] - h
            # print weights, â€˜<strong>h=%sâ€™ % h, â€˜</strong>â€˜<em>20, alpha, â€˜<strong>â€˜*20, error, â€˜</strong>â€˜</em>20, dataMatrix[randIndex]
            weights = weights + alpha * error * dataMatrix[dataIndex[randIndex]]
            del (dataIndex[randIndex])
    return weights</p>

<h1 id="å¯è§†åŒ–å±•ç¤º">å¯è§†åŒ–å±•ç¤º</h1>
<p>def plotBestFit(dataArr, labelMat, weights):
    â€˜â€™â€™
        Desc:
            å°†æˆ‘ä»¬å¾—åˆ°çš„æ•°æ®å¯è§†åŒ–å±•ç¤ºå‡ºæ¥
        Args:
            dataArr:æ ·æœ¬æ•°æ®çš„ç‰¹å¾
            labelMat:æ ·æœ¬æ•°æ®çš„ç±»åˆ«æ ‡ç­¾ï¼Œå³ç›®æ ‡å˜é‡
            weights:å›å½’ç³»æ•°
        Returns:
            None
    â€˜â€™â€™</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>n = np.shape(dataArr)[0]
xcord1 = []
ycord1 = []
xcord2 = []
ycord2 = []
for i in range(n):
    if int(labelMat[i]) == 1:
        xcord1.append(dataArr[i, 1])
        ycord1.append(dataArr[i, 2])
    else:
        xcord2.append(dataArr[i, 1])
        ycord2.append(dataArr[i, 2])
fig = plt.figure()
ax = fig.add_subplot(111)
ax.scatter(xcord1, ycord1, s=30, c='red', marker='s')
ax.scatter(xcord2, ycord2, s=30, c='green')
x = np.arange(-3.0, 3.0, 0.1)
"""
yçš„ç”±æ¥
dataMat.append([1.0, float(lineArr[0]), float(lineArr[1])])
w0*x0+w1*x1+w2*x2=f(x)
x0æœ€å¼€å§‹å°±è®¾ç½®ä¸º1å»ï¼Œ x2å°±æ˜¯æˆ‘ä»¬ç”»å›¾çš„yå€¼ï¼Œè€Œf(x)è¢«æˆ‘ä»¬ç£¨åˆè¯¯å·®ç»™ç®—åˆ°w0,w1,w2èº«ä¸Šå»äº†
æ‰€ä»¥ï¼š w0+w1*x+w2*y=0 =&gt; y = (-w0-w1*x)/w2   
"""
y = (-weights[0] - weights[1] * x) / weights[2]
ax.plot(x, y)
plt.xlabel('X')
plt.ylabel('Y')
plt.show()
</code></pre></div></div>

<p>def simpleTest():
    # 1.æ”¶é›†å¹¶å‡†å¤‡æ•°æ®
    dataMat, labelMat = loadDataSet(â€œTestSet.txtâ€)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 2.è®­ç»ƒæ¨¡å‹ï¼Œ  f(x)=a1*x1+b2*x2+..+nn*xnä¸­ (a1,b2, .., nn).Tçš„çŸ©é˜µå€¼
# å› ä¸ºæ•°ç»„æ²¡æœ‰æ˜¯å¤åˆ¶nä»½ï¼Œ arrayçš„ä¹˜æ³•å°±æ˜¯ä¹˜æ³•
dataArr = np.array(dataMat)
weights = stocGradAscent(dataArr, labelMat)
print(weights)
# æ•°æ®å¯è§†åŒ–
plotBestFit(dataArr, labelMat, weights)
</code></pre></div></div>

<p>if <strong>name</strong> == â€œ<strong>main</strong>â€:
    simpleTest()
```</p>
<h3 id="è¿è¡Œç¯å¢ƒ">è¿è¡Œç¯å¢ƒ</h3>
<p>Windows10+Anaconda Spyderï¼ˆPython 3.5)</p>
<h3 id="è¿è¡Œç»“æœ">è¿è¡Œç»“æœ</h3>
<p><img src="/image/Logisticå›å½’.PNG" alt="è¿è¡Œç»“æœ" /></p>
:ET